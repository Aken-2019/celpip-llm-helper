{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="card shadow">
    <div data-svelte-component="celpipWritting"></div>
</div>

{% endblock %}


{% block extra_js %}
<script>
    // Configuration variables from Django
    window.api2dConfig = {
        endpoint: '{{ api2d_openai_endpoint|escapejs }}',
        apiKey: '{{ api_key|escapejs }}',
        sttModel: '{{ api2d_openai_stt_model|escapejs }}',
        language: 'en',
        txtModel: '{{ api2d_openai_txt_model|escapejs }}'
    };

</script>

<!-- Safely pass multiline prompts using json_script -->
{{ celpip_improve_sys_prompt|json_script:"celpip_improve_sys_prompt" }}
{{ celpip_extend_sys_prompt|json_script:"celpip_extend_sys_prompt" }}

<!-- <script>
    // Parse the JSON data and add to config
    const improvePromptElement = document.getElementById('celpip_improve_sys_prompt');
    const extendPromptElement = document.getElementById('celpip_extend_sys_prompt');
    
    if (improvePromptElement) {
        window.api2dConfig.celpip_improve_sys_prompt = JSON.parse(improvePromptElement.textContent);
    }
    if (extendPromptElement) {
        window.api2dConfig.celpip_extend_sys_prompt = JSON.parse(extendPromptElement.textContent);
    }
</script> -->

<!-- <script src="{% static 'api2d/js/apiClient.js' %}"></script>
<script src="{% static 'api2d/js/upload_mp3.js' %}"></script> -->
{% endblock %}
